<div class="modal-overlay" (click)="onClose()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="modal-header">
      <div class="flex items-center gap-3">
        <div class="icon-wrapper">
          <lucide-icon [img]="User" [size]="24"></lucide-icon>
        </div>
        <div>
          <h2>Editar Información</h2>
          <p class="text-sm text-slate-400">Actualiza los datos del usuario</p>
        </div>
      </div>
      <button class="btn btn-ghost btn-icon" (click)="onClose()">
        <lucide-icon [img]="X" [size]="20"></lucide-icon>
      </button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      @if (error) {
        <div class="error-banner">
          <lucide-icon [img]="AlertCircle" [size]="20" class="error-icon"></lucide-icon>
          <span>{{ error }}</span>
        </div>
      }

      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <!-- Nombre -->
        <div class="form-group">
          <label for="nombre" class="required">Nombre(s)</label>
          <input
            id="nombre"
            type="text"
            formControlName="nombre"
            placeholder="Juan"
            [class.error]="form.get('nombre')?.invalid && form.get('nombre')?.touched"
          />
          @if (form.get('nombre')?.invalid && form.get('nombre')?.touched) {
            <span class="error-message">Mínimo 2 caracteres</span>
          }
        </div>

        <!-- Apellidos -->
        <div class="form-row">
          <div class="form-group">
            <label for="apellido1" class="required">Apellido paterno</label>
            <input
              id="apellido1"
              type="text"
              formControlName="apellido1"
              placeholder="Pérez"
              [class.error]="form.get('apellido1')?.invalid && form.get('apellido1')?.touched"
            />
            @if (form.get('apellido1')?.invalid && form.get('apellido1')?.touched) {
              <span class="error-message">Mínimo 2 caracteres</span>
            }
          </div>

          <div class="form-group">
            <label for="apellido2">Apellido materno</label>
            <input
              id="apellido2"
              type="text"
              formControlName="apellido2"
              placeholder="López (opcional)"
            />
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email" class="required">Correo electrónico</label>
          <input
            id="email"
            type="email"
            formControlName="email"
            placeholder="juan.perez@example.com"
            [class.error]="form.get('email')?.invalid && form.get('email')?.touched"
          />
          @if (form.get('email')?.invalid && form.get('email')?.touched) {
            <span class="error-message">Correo inválido</span>
          }
        </div>
      </form>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button class="btn btn-ghost" (click)="onClose()" [disabled]="isLoading">
        Cancelar
      </button>
      <button class="btn btn-primary" (click)="onSubmit()" [disabled]="isLoading || form.invalid">
        @if (isLoading) {
          <span class="spinner"></span>
          <span>Guardando...</span>
        } @else {
          <span>Guardar cambios</span>
        }
      </button>
    </div>
  </div>
</div>